package com.tf.eye.model.node;
import lombok.Data;
import org.springframework.data.neo4j.core.schema.*;

import java.util.HashSet;
import java.util.Set;

import static org.springframework.data.neo4j.core.schema.Relationship.Direction.INCOMING;
import static org.springframework.data.neo4j.core.schema.Relationship.Direction.OUTGOING;

@Node("Vulnerability")
@Data
public class VulnerabilityNode {

    @Id @GeneratedValue
    private Long id;
    @Property("cveId")
    private String cveId;
    @Property("title")
    private String title;
    @Property("description")
    private String description;
    @Property("publishedDate")
    private String publishedDate;
    @Property("lastModified")
    private String lastModified;
    @Relationship(type = "hasWeakness", direction = OUTGOING)
    private Set<WeaknessNode> weaknessNodes = new HashSet<>();
    @Relationship(type = "hasInfluenced", direction = OUTGOING)
    private Set<ProductNode> products = new HashSet<>();
    @Relationship(type = "hasScore", direction = OUTGOING)
    private CVSSNode cvss;


}
